<!DOCTYPE html>
<html lang='en'>
  <head>
    <title>Madrona Engine</title>
    <meta charset='UTF-8'>
    <link rel='icon' type='image/x-icon' href='favicon.ico'>
    <meta name='viewport' content='width=device-width'>
    <link href='https://fonts.googleapis.com/css?family=JetBrains+Mono' rel='stylesheet'>
    <link href='https://fonts.googleapis.com/css?family=Roboto' rel='stylesheet'>
    <link rel='stylesheet' href='style.css'>
  </head>

  <body class='blog-background'>
    <div class='madrona-nav-wrapper blog-background'>
      <div class='madrona-nav'>
        <a href='/' class='logo-wrapper'>
          <img src='madrona_simple.png' width='50' />
          <span class='logo'>Madrona&nbsp;Engine</span>
        </a>
        <div class='madrona-nav-items'>
          <a href='/#paper' class='link'>
            Paper
          </a>
          <a href='/#faq' class='link'>
            FAQ 
          </a>
          <a href='/blog.html' class='link'>
            Blog
          </a>
          <a href='https://github.com/shacklettbp/madrona' class='gh'>
            <img src='github-mark.svg' alt='GitHub' />
          </a>
        </div>
      </div>
    </div>

    <div class='blog'>

      <div id='title-nav-container' class='title-nav-container'>
        <div id='title' class='title'>
          <div class='title-bg'>
            <h1>
              <span class='title-line'>Madrona v0.2: </span>
              <span class='title-line'>Introducing the Engine's High Throughput Batch Renderer</span>
            </h1> 
            <p>Posted on Sunday, October 13th 2024 by <a href='https://www.linkedin.com/in/luc-rosenzweig/'>Luc Rosenzweig</a></p>
          </div>
        </div>

        <div id='back' class='next-button'>
          <div class='next-bg'>
            <h2>
              <a href='/blog.html'>Prev</a>
            </h2>
          </div>
        </div>
      </div>

    <section id='video'>
      <div id='main-video-container'>
        <video autoplay muted playsinline width='720' height='405' poster='renderer_thumbnail.jpg'>
          <source src='renderer.mp4' type='video/mp4' />
        </video>
        <button class='replay'><img src='replay.svg' alt='replay'></button>
      <p class="small emph">Example batch renderer outputs of the high geometry <a href="https://3dlg-hcvc.github.io/hssd/">HSSD</a> scenes.</p>
      </div>
    </section>

    <section id='intro'>
      <p>

      “Pixels to actions” training is an exciting training regime which has agents learning through images of what they see. Given that Madrona is a high-throughput batch simulator, we were compelled to explore what the most efficient architecture would be for a high-throughput batch renderer capable of rendering thousands of small images (64x64 to 256x256 in resolution) from the agents’ point of view.  Such a renderer would have different requirements than your typical renderer for a video game. For one, throughput is much more important than latency - it doesn’t matter if rendering a single 128x128 image takes 15ms so long as rendering 1024 images at once also takes 15ms. Furthermore, realism isn’t a hard requirement like it is in certain video games: learning experiments don’t require full path tracers and can make due with simple phong lighting as seen here.


There are two established algorithms for image synthesis: rasterization and ray tracing.  We therefore explored both approaches with what we believe to be well-tuned implementations. Our findings show that the software ray tracer performs better than the rasterizer in many important situations such as training on an H100, on high geometry scenes or when in need of supporting effects like shadows.

     <p class='detail blurb'>
     For more information, see the following resources:
     <ul class='resources-list'>
       <li><a href='https://github.com/llGuy/madrona_benchmark'>Benchmark Repository for Reproducing the Timings from the Paper</a></li>
       <li><a href='https://github.com/llGuy/madrona_renderer'>Madrona Renderer (Standalone Batch Renderer which can be Plugged into any Engine)</a></li>
       <li><a href='https://github.com/llGuy/madrona_mjx'>Madrona MJX (Example of Using Madrona's Renderer with MuJoCo MJX)</a></li>
          <li><a href="#render-faq">Madrona Renderer FAQ</a></li>
     </ul>
     </p>
    </section>

    <section id='paper' class='info-section'>
      <h1>Renderer Technical Paper</h1>
      <div class='content'>
        <p class='detail'>
           Please refer to our technical paper for an in-depth description of Madrona's batch renderer.
        </p>

        <div class='paper-block'>
          <div class='paper-title-wrapper'>
            <a class='paper-title' href='shacklett_siggraph23.pdf' target='_blank'>
                High-Throughput Batch Rendering for Embodied AI
            </a>
          </div>
          <div class='paper-details-wrapper'>
            <div id='paper-details' class='paper-details'>
              <div class='authors'>
                <a href='https://www.linkedin.com/in/luc-rosenzweig/'>Luc&nbsp;Guy Rosenzweig</a>,
                <a href='https://cs.stanford.edu/~bps'>Brennan&nbsp;Shacklett</a>,
                <a href='https://www.linkedin.com/in/warren-xia-2a55641b6/'>Warren Xia</a>,
                <a href='http://graphics.stanford.edu/~kayvonf/'>Kayvon&nbsp;Fatahalian</a>
              </div>
              <div class='conference'>
                Proceedings of SIGGRAPH Asia 2024
              </div>
            </div>
            <div id='paper-download'>
              <a href='madrona-renderer.pdf' target='_blank'>
                <span class='pdf-download-icon material-symbols-outlined'>description</span><div class='pdf-download-text'>PDF</div>
              </a>
            </div>
          </div>
        </div>

        <h3>Abstract</h3>
        <p class='detail paper-abstract'>
          In this paper we study the problem of efficiently rendering images for embodied AI training workloads, where agent training involves rendering millions to billions of independent, low-resolution frames, often with simple lighting and shading, that serve as the agent's observations of the world. To enable high-throughput training from images, we design a flexible, batch-mode rendering interface that allows state-of-the-art GPU-accelerated batch world simulators to efficiently communicate with high-performance rendering backends. Using this interface we architect and compare two high-performance renderers: one based on the GPU hardware-accelerated graphics pipeline and a second based on a GPU software implementation of ray tracing. To evaluate these renderers and encourage further research by the graphics community in this area, we build a rendering benchmark for this under-explored regime. We find that the ray tracing renderer outperforms the rasterization-based solution across the benchmark on a datacenter-class GPU, while also performing competitively in geometrically complex environments on a high-end consumer GPU. When tasked to render large batches of independent 128x128 images, the ray tracer can exceed 100,000 frames per second per GPU for simple scenes, and exceed 10,000 frames per second per GPU on geometrically complex scenes from the HSSD dataset. 
        </p>

        <h3>Citation</h3>
        <pre class='citation'><code>@article{rosenzweig24madronarenderer,
    title   = {High-Throughput Batch Rendering for Embodied AI},
    author  = {Luc Guy Rosenzweig and Brennan Shacklett and
               Warren Xia and 
               Kayvon Fatahalian},
    conference = {SIGGRAPH Asia 2024 Conference Papers},
    year    = {2024}
}</code></pre>
      </div>
    </section>

    <section id='render-faq' class='info-section'>
      <h1>FAQ</h1>
      <div class='content'>

        <h3>How programmable is the ray tracer?</h3>

        <p class='detail'>
        Currently, the output of the ray tracer is hardcoded to RGB and depth with optional shadows as you can see <a href="https://github.com/shacklettbp/madrona/blob/18268e97fa6fbc3c7f3760b871a1ec8dcf3b3000/src/mw/device/bvh_raycast.cpp#L784">here</a>. However, we plan to create a way for users to program their own "ray tracing shaders" in the Madrona framework in the future. For now, users must hardcode modifications at the location linked previously.
        </p>

        <h3>I need a batch renderer for my non-Madrona application! How can I use your renderers for my use case?</h3>

        <p class='detail'>
        See the Madrona Renderer repository linked in the additional resources linked above the paper. There, you can see an example of just using the renderer which can be plugged into whatever application you like!
        </p>

      </div>
    </section>

    </div>
  </body>
</html>
