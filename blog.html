<!DOCTYPE html>
<html lang='en'>
  <head>
    <title>Madrona Engine</title>
    <meta charset='UTF-8'>
    <meta name='viewport' content='width=device-width, initial-scale=1'>
    <link href='https://fonts.googleapis.com/css?family=JetBrains+Mono' rel='stylesheet'>
    <link href='https://fonts.googleapis.com/css?family=Roboto' rel='stylesheet'>
    <link rel='stylesheet' href='style.css'>
  </head>

  <body>
    <div class='madrona-nav-wrapper'>
      <div class='madrona-nav'>
        <a href='#'>
          <img src='madrona_simple.png' width='50' />
          <span class='logo'>Madrona&nbsp;Engine</span>
        </a>
        <div class='madrona-nav-items'>
          <a href='#paper' class='link'>
            Paper
          </a>
          <a href='#faq' class='link'>
            FAQ 
          </a>
          <!-- <a href='#' class='link'>
            Blog
            </a> -->
            <a href='https://github.com/shacklettbp/madrona' class='gh'>
              <img src='github-mark.svg' alt='GitHub' />
            </a>
        </div>
      </div>
    </div>

    <div class='blog'>
      <div id='title' class='title'>
        <div class='title-bg'>
          <h1>Madrona v0.1: A Game Engine for Training Agents</h1> 
          <p>Posted on Sunday, August 6th by <a href='https://cs.stanford.edu/~bps'>Brennan Shacklett</a></p>
        </div>
      </div>
      <section id='intro'>
        <p>
        After about a year of work, I'm happy to announce the initial release of the Madrona Engine. Madrona is a new type of game engine designed from the ground up for the unique workload of training agents using algorithms like reinforcement learning. With this release, we hope to provide a useful platform for creating high-performance learning environments across a broad range of exciting applications such as <a href='https://openai.com/research/openai-five'>learning complex game strategies</a>, <a href='https://arxiv.org/pdf/2011.01975.pdf'>robotics / embodied AI</a>, and <a href='https://arxiv.org/abs/2307.11105'>game development</a>.
      </section>
      <section id='different'>
        <h3>What makes Madrona different from existing game engines?</h3>
        <p>
        Learning environments built on Madrona are able to simulate batches of thousands of environments simultaneously <em>by default</em>, enabling high-throughput experience generation for learning. This is in contrast to existing game engines that are designed to execute a single game instance at real-time rates. By treating parallel batch execution of many environments as a first class notion in the engine, Madrona is able to map this parallel workload entirely onto the GPU and achieve order of magnitude speedups over CPU execution.
        </p>
      </section>
      <section id='ml'>
        <h3>Machine Learning Impact</h3>
        <p>
        For machine learning researchers, the massive speedups enabled by Madrona's architecture result in very tangible changes to learning workflows. For example, my colleague <a href='https://bsarkar321.github.io/'>Bidipta Sarkar</a> ported the <a href="https://github.com/HumanCompatibleAI/overcooked_ai">Overcooked AI</a> environment to Madrona and achieved a <strong>60x</strong> speedup to end-to-end training. Concretely, his training runs dropped from over an hour to under a minute! In fact, you can use this <a href='https://colab.research.google.com/github/bsarkar321/madrona_rl_envs/blob/master/overcooked_compiled_colab.ipynb'>Colab notebook</a> to train Overcooked agents on a free GPU in just a couple minutes. Overall, these kind of speedups significantly improve research iteration times and open up new algorithmic possibilities. I highly recommend reading Bidipta's <a href="https://bsarkar321.github.io/blog/overcooked_madrona/index.html">blog post</a> for a detailed account of the impact on his research as well as the nitty gritty technical details of porting Overcooked AI to Madrona and optimizing it.
        </p>
      </section>
      <section id='arch'>
        <h3>Engine Architecture Overview</h3>
        <p>
        The core technical idea behind Madrona is the realization that the Entity Component System (ECS) architecture from the game industry is a great fit for batch GPU execution of many learning environments. Specifically, the overall structure and separation of code and data provided by an ECS allow Madrona to efficiently map custom learning environment logic onto the GPU by maintaining coherent execution and access patterns while also managing the complexity of linking many diverse subsystems together efficiently. If you're not familiar with the ECS architecture, I highly recommend Sander Mertens' excellent <a href='https://github.com/SanderMertens/ecs-faq'>ECS FAQ</a>, as well as <a href='https://www.youtube.com/watch?v=zrIY0eIyqmI'>this GDC talk</a> from one of the developers of Overwatch.
        </p>
        <p>
        Expect the next post on this blog to be a deeper dive into my reasoning behind choosing the ECS architecture for Madrona and why I think the "game engine" abstraction is extremely useful for building learning environments.
        </p>
      </section>
      <section id='arch'>
        <h3>Next Steps</h3>
        <p>
        Hopefully this short post has piqued your interest in learning more about the engine and perhaps playing around with it. If so, the following resources are good starting points:
        <ul>
          <li>
            The <a href='https://github.com/shacklettbp/madrona_escape_room'>Madrona Escape Room</a> example environment is 
          </li>
          <li>
          </li>
        </ul>


        </p>
      </section>


    </div>
  </body>
</html>
